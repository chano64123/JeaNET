ü
5F:\UPT\VII CICLO\Z JEANET\Sistema\Datos\ClsDalerta.cs
	namespace 	
Datos
 
{ 
public 

class 

ClsDalerta 
{ 
readonly 
bdJeaNetEntities !
db" $
=% &
new' *
bdJeaNetEntities+ ;
(; <
)< =
;= >
public		 
bool		 
agregarAlerta		 !
(		! "
	tbAlertas		" +
alerta		, 2
)		2 3
{		4 5
try

 
{

 
db 
. 
	tbAlertas 
. 
Add  
(  !
alerta! '
)' (
;( )
db 
. 
SaveChanges 
( 
)  
;  !
return 
true 
; 
} 
catch 
( 
	Exception 
) 
{  !
return 
false 
; 
} 
} 	
public 
List 
< 
	tbAlertas 
> 
listarAlertas ,
(, -
string- 3
dni4 7
)7 8
{9 :
var 
query 
= 
from 
e 
in !
db" $
.$ %
	tbAlertas% .
where/ 4
e5 6
.6 7
DniCli7 =
==> @
dniA D
selectE K
eL M
;M N
return 
query 
. 
ToList 
(  
)  !
;! "
} 	
public 
List 
< 
	tbAlertas 
> 
listarAlerta +
(+ ,
), -
{. /
var 
query 
= 
from 
e 
in !
db" $
.$ %
	tbAlertas% .
select/ 5
e6 7
;7 8
return 
query 
. 
ToList 
(  
)  !
;! "
} 	
} 
} ≈
8F:\UPT\VII CICLO\Z JEANET\Sistema\Datos\ClsDauditoria.cs
	namespace 	
Datos
 
{ 
public 

class 
ClsDauditoria 
{  
readonly 
bdJeaNetEntities !
db" $
=% &
new' *
bdJeaNetEntities+ ;
(; <
)< =
;= >
public		 
bool		 
agregarAuditoria		 $
(		$ %
tbAuditoria		% 0
	auditoria		1 :
)		: ;
{		< =
try

 
{

 
db 
. 
tbAuditoria 
. 
Add "
(" #
	auditoria# ,
), -
;- .
db 
. 
SaveChanges 
( 
)  
;  !
return 
true 
; 
} 
catch 
( 
	Exception 
) 
{  !
return 
false 
; 
} 
} 	
public 
List 
< 
tbAuditoria 
>  
listarAuditoria! 0
(0 1
)1 2
{3 4
var 
query 
= 
from 
e 
in !
db" $
.$ %
tbAuditoria% 0
select1 7
e8 9
;9 :
return 
query 
. 
ToList 
(  
)  !
;! "
} 	
public 
List 
< 
tbAuditoria 
>  
filtrarAuditoria! 1
(1 2
string2 8
filtro9 ?
)? @
{A B
var 
query 
= 
from 
e 
in !
db" $
.$ %
tbAuditoria% 0
where1 6
e7 8
.8 9
DNI_Usuario9 D
.D E
ContainsE M
(M N
filtroN T
)T U
||V X
eY Z
.Z [
descripcionAccion[ l
.l m
Containsm u
(u v
filtrov |
)| }
||	~ Ä
e
Å Ç
.
Ç É
fecha
É à
.
à â
ToString
â ë
(
ë í
)
í ì
.
ì î
Contains
î ú
(
ú ù
filtro
ù £
)
£ §
||
• ß
e
® ©
.
© ™
hora
™ Æ
.
Æ Ø
Contains
Ø ∑
(
∑ ∏
filtro
∏ æ
)
æ ø
select
¿ ∆
e
« »
;
» …
return 
query 
. 
ToList 
(  
)  !
;! "
} 	
} 
} Ú
4F:\UPT\VII CICLO\Z JEANET\Sistema\Datos\ClsDcargo.cs
	namespace 	
Datos
 
{ 
public 

class 
	ClsDcargo 
{ 
readonly 
bdJeaNetEntities !
db" $
=% &
new' *
bdJeaNetEntities+ ;
(; <
)< =
;= >
public

 
bool

 
agregarCargo

  
(

  !
tbCargos

! )
cargo

* /
)

/ 0
{

1 2
try 
{ 
db 
. 
tbCargos 
. 
Add 
(  
cargo  %
)% &
;& '
db 
. 
SaveChanges 
( 
)  
;  !
return 
true 
; 
} 
catch 
( 
	Exception 
) 
{  !
return 
false 
; 
} 
} 	
public 
bool 
modificarCargo "
(" #
tbCargos# +
cargo, 1
)1 2
{3 4
try 
{ 
db 
. 
Entry 
( 
cargo 
) 
.  
State  %
=& '
EntityState( 3
.3 4
Modified4 <
;< =
db 
. 
SaveChanges 
( 
)  
;  !
return 
true 
; 
} 
catch 
( 
	Exception 
) 
{  !
return 
false 
; 
} 
} 	
public 
List 
< 
tbCargos 
> 
listarCargos *
(* +
)+ ,
{- .
var 
query 
= 
from 
e 
in !
db" $
.$ %
tbCargos% -
select. 4
e5 6
;6 7
return   
query   
.   
ToList   
(    
)    !
;  ! "
}!! 	
public## 
List## 
<## 
tbCargos## 
>## 
filtrarCargos## +
(##+ ,
string##, 2
filtro##3 9
)##9 :
{##; <
var$$ 
query$$ 
=$$ 
from$$ 
e$$ 
in$$ !
db$$" $
.$$$ %
tbCargos$$% -
where$$. 3
e$$4 5
.$$5 6
Codigo_Cargo$$6 B
.$$B C
Contains$$C K
($$K L
filtro$$L R
)$$R S
||$$T V
e$$W X
.$$X Y
Descripcion$$Y d
.$$d e
Contains$$e m
($$m n
filtro$$n t
)$$t u
select$$v |
e$$} ~
;$$~ 
return%% 
query%% 
.%% 
ToList%% 
(%%  
)%%  !
;%%! "
}&& 	
public(( 
List(( 
<(( 
tbCargos(( 
>(( 
busquedaCargo(( +
(((+ ,
string((, 2
codigoCargo((3 >
)((> ?
{((@ A
var)) 
query)) 
=)) 
from)) 
e)) 
in)) !
db))" $
.))$ %
tbCargos))% -
where)). 3
e))4 5
.))5 6
Codigo_Cargo))6 B
==))C E
codigoCargo))F Q
select))R X
e))Y Z
;))Z [
return** 
query** 
.** 
ToList** 
(**  
)**  !
;**! "
}++ 	
},, 
}-- ÿ 
6F:\UPT\VII CICLO\Z JEANET\Sistema\Datos\ClsDcliente.cs
	namespace 	
Datos
 
{ 
public 

class 
ClsDcliente 
{ 
readonly 
bdJeaNetEntities !
db" $
=% &
new' *
bdJeaNetEntities+ ;
(; <
)< =
;= >
public

 
bool

 
agregarCliente

 "
(

" #

tbClientes

# -
cliente

. 5
)

5 6
{

7 8
try 
{ 
db 
. 

tbClientes 
. 
Add !
(! "
cliente" )
)) *
;* +
db 
. 
SaveChanges 
( 
)  
;  !
return 
true 
; 
} 
catch 
( 
	Exception 
) 
{  !
return 
false 
; 
} 
} 	
public 
bool 
modificarCliente $
($ %

tbClientes% /
cliente0 7
)7 8
{9 :
try 
{ 
db 
. 
Entry 
( 
cliente  
)  !
.! "
State" '
=( )
EntityState* 5
.5 6
Modified6 >
;> ?
db 
. 
SaveChanges 
( 
)  
;  !
return 
true 
; 
} 
catch 
( 
	Exception 
) 
{  !
return 
false 
; 
} 
} 	
public 
List 
< 

tbClientes 
> 
listarCliente  -
(- .
). /
{0 1
var 
query 
= 
from 
e 
in !
db" $
.$ %

tbClientes% /
select0 6
e7 8
;8 9
return   
query   
.   
ToList   
(    
)    !
;  ! "
}!! 	
public## 
List## 
<## 

tbClientes## 
>## 
filtrarCliente##  .
(##. /
string##/ 5
filtro##6 <
)##< =
{##> ?
var$$ 
query$$ 
=$$ 
from$$ 
e$$ 
in$$ !
db$$" $
.$$$ %

tbClientes$$% /
where$$0 5
e$$6 7
.$$7 8

DniCliente$$8 B
.$$B C
Contains$$C K
($$K L
filtro$$L R
)$$R S
||$$T V
e$$W X
.$$X Y
Nombres$$Y `
.$$` a
Contains$$a i
($$i j
filtro$$j p
)$$p q
||$$r t
e$$u v
.$$v w
	Apellidos	$$w Ä
.
$$Ä Å
Contains
$$Å â
(
$$â ä
filtro
$$ä ê
)
$$ê ë
||
$$í î
e
$$ï ñ
.
$$ñ ó
Estado
$$ó ù
.
$$ù û
Contains
$$û ¶
(
$$¶ ß
filtro
$$ß ≠
)
$$≠ Æ
select
$$Ø µ
e
$$∂ ∑
;
$$∑ ∏
return%% 
query%% 
.%% 
ToList%% 
(%%  
)%%  !
;%%! "
}&& 	
public(( 
List(( 
<(( 

tbClientes(( 
>(( 
busquedaCliente((  /
(((/ 0
string((0 6
dni((7 :
)((: ;
{((< =
var)) 
query)) 
=)) 
from)) 
e)) 
in)) !
db))" $
.))$ %

tbClientes))% /
where))0 5
e))6 7
.))7 8

DniCliente))8 B
==))C E
dni))F I
select))J P
e))Q R
;))R S
return** 
query** 
.** 
ToList** 
(**  
)**  !
;**! "
}++ 	
},, 
}-- ˚
AF:\UPT\VII CICLO\Z JEANET\Sistema\Datos\ClsDclienteDispositivo.cs
	namespace 	
Datos
 
{ 
public 

class "
ClsDclienteDispositivo '
{( )
readonly 
bdJeaNetEntities !
db" $
=% &
new' *
bdJeaNetEntities+ ;
(; <
)< =
;= >
public 
bool %
agregarClienteDispositivo -
(- .
tbClienteDisposiivo. A
clienteDispositivoB T
)T U
{V W
try 
{ 
db		 
.		 
tbClienteDisposiivo		 &
.		& '
Add		' *
(		* +
clienteDispositivo		+ =
)		= >
;		> ?
db

 
.

 
SaveChanges

 
(

 
)

  
;

  !
return 
true 
; 
} 
catch 
( 
	Exception 
) 
{  !
return 
false 
; 
} 
} 	
} 
} ’-
:F:\UPT\VII CICLO\Z JEANET\Sistema\Datos\ClsDcomprobante.cs
	namespace 	
Datos
 
{ 
public 

class 
ClsDcomprobante  
{! "
readonly 
bdJeaNetEntities !
db" $
=% &
new' *
bdJeaNetEntities+ ;
(; <
)< =
;= >
public

 
bool

 
agregarComprobante

 &
(

& '
tbComprobante

' 4
comprobante

5 @
)

@ A
{

B C
try 
{ 
db 
. 
tbComprobante  
.  !
Add! $
($ %
comprobante% 0
)0 1
;1 2
db 
. 
SaveChanges 
( 
)  
;  !
return 
true 
; 
} 
catch 
( 
	Exception 
) 
{  !
return 
false 
; 
} 
} 	
public 
bool  
modificarComprobante (
(( )
tbComprobante) 6
comprobante7 B
)B C
{D E
try 
{ 
db 
. 
Entry 
( 
comprobante $
)$ %
.% &
State& +
=, -
EntityState. 9
.9 :
Modified: B
;B C
db 
. 
SaveChanges 
( 
)  
;  !
return 
true 
; 
} 
catch 
( 
	Exception 
) 
{  !
return 
false 
; 
} 
} 	
public 
List 
< 
tbComprobante !
>! "
listarComprobantes# 5
(5 6
)6 7
{8 9
var 
query 
= 
from 
e 
in !
db" $
.$ %
tbComprobante% 2
select3 9
e: ;
;; <
return   
query   
.   
ToList   
(    
)    !
;  ! "
}!! 	
public## 
List## 
<## 
tbComprobante## !
>##! "
filtrarComprobantes### 6
(##6 7
string##7 =
filtro##> D
)##D E
{##F G
var$$ 
query$$ 
=$$ 
from$$ 
e$$ 
in$$ !
db$$" $
.$$$ %
tbComprobante$$% 2
where$$3 8
e$$9 :
.$$: ;
Numero$$; A
.$$A B
Contains$$B J
($$J K
filtro$$K Q
)$$Q R
||$$S U
e$$V W
.$$W X
Serie$$X ]
.$$] ^
Contains$$^ f
($$f g
filtro$$g m
)$$m n
||$$o q
e$$r s
.$$s t

DniCliente$$t ~
.$$~ 
Contains	$$ á
(
$$á à
filtro
$$à é
)
$$é è
||
$$ê í
e
$$ì î
.
$$î ï
DniEmpleado
$$ï †
.
$$† °
Contains
$$° ©
(
$$© ™
filtro
$$™ ∞
)
$$∞ ±
select
$$≤ ∏
e
$$π ∫
;
$$∫ ª
return%% 
query%% 
.%% 
ToList%% 
(%%  
)%%  !
;%%! "
}&& 	
public(( 
List(( 
<(( 
tbComprobante(( !
>((! "
busquedaComprobante((# 6
(((6 7
string((7 =
codigoComprobante((> O
)((O P
{((Q R
var)) 
query)) 
=)) 
from)) 
e)) 
in)) !
db))" $
.))$ %
tbComprobante))% 2
where))3 8
e))9 :
.)): ;
Numero)); A
==))B D
codigoComprobante))E V
select))W ]
e))^ _
;))_ `
return** 
query** 
.** 
ToList** 
(**  
)**  !
;**! "
}++ 	
public-- 
bool-- %
agregarDetalleComprobante-- -
(--- . 
tbDetalleComprobante--. B
detalleComprobante--C U
)--U V
{--W X
try.. 
{.. 
db// 
.//  
tbDetalleComprobante// '
.//' (
Add//( +
(//+ ,
detalleComprobante//, >
)//> ?
;//? @
db00 
.00 
SaveChanges00 
(00 
)00  
;00  !
return11 
true11 
;11 
}22 
catch22 
(22 
	Exception22 
)22 
{22  !
return33 
false33 
;33 
}44 
}55 	
public77 
List77 
<77  
tbDetalleComprobante77 (
>77( )%
listarDetalleComprobantes77* C
(77C D
string77D J
serie77K P
,77P Q
string77R X
numero77Y _
)77_ `
{77a b
var88 
query88 
=88 
from88 
e88 
in88 !
db88" $
.88$ % 
tbDetalleComprobante88% 9
where88: ?
e88@ A
.88A B
Serie88B G
==88H J
serie88K P
&&88Q S
e88T U
.88U V
Numero88V \
==88] _
numero88` f
select88g m
e88n o
;88o p
return99 
query99 
.99 
ToList99 
(99  
)99  !
;99! "
}:: 	
}<< 
}== ∂
:F:\UPT\VII CICLO\Z JEANET\Sistema\Datos\ClsDdispositivo.cs
	namespace 	
Datos
 
{ 
public 

class 
ClsDdispositivo  
{! "
readonly

 
bdJeaNetEntities

 !
db

" $
=

% &
new

' *
bdJeaNetEntities

+ ;
(

; <
)

< =
;

= >
public 
bool 
agregarDispositivo &
(& '
tbDispositivos' 5
dispositivos6 B
)B C
{D E
try 
{ 
db 
. 
tbDispositivos !
.! "
Add" %
(% &
dispositivos& 2
)2 3
;3 4
db 
. 
SaveChanges 
( 
)  
;  !
return 
true 
; 
} 
catch 
( 
	Exception 
) 
{  !
return 
false 
; 
} 
} 	
public 
List 
< 
tbDispositivos "
>" #)
listarDispositivosDisponibles$ A
(A B
stringB H
codigoI O
)O P
{P Q
var 
query 
= 
from 
e 
in !
db" $
.$ %
tbDispositivos% 3
where4 9
e: ;
.; <
CodLote< C
==D F
codigoG M
&&N P
eQ R
.R S
EstadoS Y
==Z \
$str] `
selecta g
eh i
;i j
return 
query 
. 
ToList 
(  
)  !
;! "
} 	
public 
List 
< 
tbDispositivos "
>" #
listarDispositivos$ 6
(6 7
)7 8
{9 :
var 
query 
= 
from 
e 
in !
db" $
.$ %
tbDispositivos% 3
select4 :
e; <
;< =
return 
query 
. 
ToList 
(  
)  !
;! "
} 	
public 
bool 
modificarEstado #
(# $
tbDispositivos$ 2
dispositivos3 ?
)? @
{A B
try   
{   
var!! 
query!! 
=!! 
(!! 
from!! !
e!!" #
in!!$ &
db!!' )
.!!) *
tbDispositivos!!* 8
where!!9 >
e!!? @
.!!@ A
SerieDispositivo!!A Q
==!!R T
dispositivos!!U a
.!!a b
SerieDispositivo!!b r
select!!s y
e!!z {
)!!{ |
.!!| }
FirstOrDefault	!!} ã
(
!!ã å
)
!!å ç
;
!!ç é
query"" 
."" 
Estado"" 
="" 
dispositivos"" +
.""+ ,
Estado"", 2
;""2 3
db## 
.## 
SaveChanges## 
(## 
)##  
;##  !
return$$ 
true$$ 
;$$ 
}%% 
catch%% 
(%% 
EntityException%% $
e%%% &
)%%& '
{%%( )

MessageBox&& 
.&& 
Show&& 
(&&  
e&&  !
.&&! "
ToString&&" *
(&&* +
)&&+ ,
)&&, -
;&&- .
return'' 
false'' 
;'' 
}(( 
})) 	
}** 
}++ ﬂ8
7F:\UPT\VII CICLO\Z JEANET\Sistema\Datos\ClsDempleado.cs
	namespace 	
Datos
 
{ 
public 

class 
ClsDempleado 
{ 
readonly 
bdJeaNetEntities !
db" $
=% &
new' *
bdJeaNetEntities+ ;
(; <
)< =
;= >
public

 
bool

 
agregarEmpleado

 #
(

# $
tbEmpleados

$ /
empleado

0 8
)

8 9
{

: ;
try 
{ 
db 
. 
tbEmpleados 
. 
Add "
(" #
empleado# +
)+ ,
;, -
db 
. 
SaveChanges 
( 
)  
;  !
return 
true 
; 
} 
catch 
( 
	Exception 
) 
{  !
return 
false 
; 
} 
} 	
public 
bool 
modificarEmpleado %
(% &
tbEmpleados& 1
empleado2 :
): ;
{< =
try 
{ 
db 
. 
Entry 
( 
empleado !
)! "
." #
State# (
=) *
EntityState+ 6
.6 7
Modified7 ?
;? @
db 
. 
SaveChanges 
( 
)  
;  !
return 
true 
; 
} 
catch 
( 
	Exception 
) 
{  !
return 
false 
; 
} 
} 	
public 
List 
< 
tbEmpleados 
>  
listarEmpleado! /
(/ 0
)0 1
{2 3
var 
query 
= 
from 
e 
in !
db" $
.$ %
tbEmpleados% 0
select1 7
e8 9
;9 :
return   
query   
.   
ToList   
(    
)    !
;  ! "
}!! 	
public## 
List## 
<## 
tbEmpleados## 
>##  
filtrarEmpleado##! 0
(##0 1
string##1 7
filtro##8 >
)##> ?
{##@ A
var$$ 
query$$ 
=$$ 
from$$ 
e$$ 
in$$ !
db$$" $
.$$$ %
tbEmpleados$$% 0
where$$1 6
e$$7 8
.$$8 9
DniEmpleado$$9 D
.$$D E
Contains$$E M
($$M N
filtro$$N T
)$$T U
||$$V X
e$$Y Z
.$$Z [
Nombres$$[ b
.$$b c
Contains$$c k
($$k l
filtro$$l r
)$$r s
||$$t v
e$$w x
.$$x y
	Apellidos	$$y Ç
.
$$Ç É
Contains
$$É ã
(
$$ã å
filtro
$$å í
)
$$í ì
||
$$î ñ
e
$$ó ò
.
$$ò ô
	Direccion
$$ô ¢
.
$$¢ £
Contains
$$£ ´
(
$$´ ¨
filtro
$$¨ ≤
)
$$≤ ≥
||
$$¥ ∂
e
$$∑ ∏
.
$$∏ π
Codigo_Cargo
$$π ≈
.
$$≈ ∆
Contains
$$∆ Œ
(
$$Œ œ
filtro
$$œ ’
)
$$’ ÷
||
$$◊ Ÿ
e
$$⁄ €
.
$$€ ‹
Telefono
$$‹ ‰
.
$$‰ Â
Contains
$$Â Ì
(
$$Ì Ó
filtro
$$Ó Ù
)
$$Ù ı
||
$$ˆ ¯
e
$$˘ ˙
.
$$˙ ˚
Estado
$$˚ Å
.
$$Å Ç
Contains
$$Ç ä
(
$$ä ã
filtro
$$ã ë
)
$$ë í
select
$$ì ô
e
$$ö õ
;
$$õ ú
return%% 
query%% 
.%% 
ToList%% 
(%%  
)%%  !
;%%! "
}&& 	
public(( 
List(( 
<(( 
tbEmpleados(( 
>((  
busquedaEmpleado((! 1
(((1 2
string((2 8
dni((9 <
)((< =
{((> ?
var)) 
query)) 
=)) 
from)) 
e)) 
in)) !
db))" $
.))$ %
tbEmpleados))% 0
where))1 6
e))7 8
.))8 9
DniEmpleado))9 D
==))E G
dni))H K
select))L R
e))S T
;))T U
return** 
query** 
.** 
ToList** 
(**  
)**  !
;**! "
}++ 	
public-- 
List-- 
<-- 
tbEmpleados-- 
>--  
verificarExistencia--! 4
(--4 5
string--5 ;
texto--< A
)--A B
{--C D
var.. 
query.. 
=.. 
from.. 
e.. 
in.. !
db.." $
...$ %
tbEmpleados..% 0
where..1 6
e..7 8
...8 9
Usuario..9 @
==..A C
texto..D I
||..J L
e..N O
...O P
Correo..P V
==..V X
texto..X ]
select..^ d
e..e f
;..f g
return// 
query// 
.// 
ToList// 
(//  
)//  !
;//! "
}00 	
public22 
List22 
<22 
tbEmpleados22 
>22  
buscarPorUsuario22! 1
(221 2
string222 8
usuario229 @
)22@ A
{22B C
var33 
query33 
=33 
from33 
e33 
in33 !
db33" $
.33$ %
tbEmpleados33% 0
where331 6
e337 8
.338 9
Usuario339 @
==33A C
usuario33D K
select33L R
e33S T
;33T U
return44 
query44 
.44 
ToList44 
(44  
)44  !
;44! "
}55 	
public77 
bool77  
modificarContrase√±a77 '
(77' (
string77( .
clave77/ 4
,774 5
string775 ;
dni77< ?
)77? @
{77A B
try88 
{88 
tbEmpleados99 
empleado99 $
=99% &
busquedaEmpleado99' 7
(997 8
dni998 ;
)99; <
[99< =
$num99= >
]99> ?
;99? @
empleado:: 
.:: 
Contrase√±a:: #
=::$ %
clave::& +
;::+ ,
db;; 
.;; 
Entry;; 
(;; 
empleado;; !
);;! "
.;;" #
State;;# (
=;;) *
EntityState;;+ 6
.;;6 7
Modified;;7 ?
;;;? @
db== 
.== 
SaveChanges== 
(== 
)==  
;==  !
return>> 
true>> 
;>> 
}?? 
catch?? 
(?? 
	Exception?? 
)?? 
{??  !
return@@ 
false@@ 
;@@ 
}AA 
}BB 	
}CC 
}DD õ
5F:\UPT\VII CICLO\Z JEANET\Sistema\Datos\ClsDkardex.cs
	namespace 	
Datos
 
{ 
public 

class 

ClsDkardex 
{ 
readonly 
bdJeaNetEntities !
db" $
=% &
new' *
bdJeaNetEntities+ ;
(; <
)< =
;= >
public		 
bool		 
agregarKardex		 !
(		! "
tbKardex		" *
kardex		+ 1
)		1 2
{		3 4
try

 
{

 
db 
. 
tbKardex 
. 
Add 
(  
kardex  &
)& '
;' (
db 
. 
SaveChanges 
( 
)  
;  !
return 
true 
; 
} 
catch 
( 
	Exception 
) 
{  !
return 
false 
; 
} 
} 	
public 
List 
< 
tbKardex 
> 
listarKardex *
(* +
)+ ,
{- .
var 
query 
= 
from 
e 
in !
db" $
.$ %
tbKardex% -
select. 4
e5 6
;6 7
return 
query 
. 
ToList 
(  
)  !
;! "
} 	
} 
} Û(
3F:\UPT\VII CICLO\Z JEANET\Sistema\Datos\ClsDlote.cs
	namespace 	
Datos
 
{ 
public 

class 
ClsDlote 
{ 
readonly 
bdJeaNetEntities !
db" $
=% &
new' *
bdJeaNetEntities+ ;
(; <
)< =
;= >
public

 
List

 
<

 
tbLotes

 
>

 
listarLotes

 (
(

( )
)

) *
{

+ ,
var 
query 
= 
from 
e 
in !
db" $
.$ %
tbLotes% ,
select- 3
e4 5
;5 6
return 
query 
. 
ToList 
(  
)  !
;! "
} 	
public 
bool 
agregarLote 
(  
tbLotes  '
lote( ,
), -
{. /
try 
{ 
db 
. 
tbLotes 
. 
Add 
( 
lote #
)# $
;$ %
db 
. 
SaveChanges 
( 
)  
;  !
return 
true 
; 
} 
catch 
( 
	Exception 
) 
{  !
return 
false 
; 
} 
} 	
public 
List 
< 
tbLotes 
> 
busquedaLote )
() *
string* 0
codlote1 8
)8 9
{: ;
var 
query 
= 
from 
e 
in !
db" $
.$ %
tbLotes% ,
where- 2
e3 4
.4 5
CodLote5 <
=== ?
codlote@ G
selectH N
eO P
;P Q
return 
query 
. 
ToList 
(  
)  !
;! "
} 	
public 
List 
< 
tbLotes 
> 
filtrarLotes )
() *
string* 0
filtro1 7
)7 8
{9 :
var 
query 
= 
from 
e 
in !
db" $
.$ %
tbLotes% ,
where- 2
e3 4
.4 5
CodLote5 <
.< =
Contains= E
(E F
filtroF L
)L M
||N P
eQ R
.R S
NombreS Y
.Y Z
ContainsZ b
(b c
filtroc i
)i j
||k m
en o
.o p
Colorp u
.u v
Containsv ~
(~ 
filtro	 Ö
)
Ö Ü
||
á â
e
ä ã
.
ã å
Sistema_Operativo
å ù
.
ù û
Contains
û ¶
(
¶ ß
filtro
ß ≠
)
≠ Æ
select
Ø µ
e
∂ ∑
;
∑ ∏
return   
query   
.   
ToList   
(    
)    !
;  ! "
}!! 	
public## 
bool## 
modificarLote## !
(##! "
tbLotes##" )
lote##* .
)##. /
{##0 1
try$$ 
{$$ 
db%% 
.%% 
Entry%% 
(%% 
lote%% 
)%% 
.%% 
State%% $
=%%% &
EntityState%%' 2
.%%2 3
Modified%%3 ;
;%%; <
db&& 
.&& 
SaveChanges&& 
(&& 
)&&  
;&&  !
return'' 
true'' 
;'' 
}(( 
catch(( 
((( 
	Exception(( 
)(( 
{((  !
return)) 
false)) 
;)) 
}** 
}++ 	
public-- 
bool-- 
decrementarLote-- #
(--# $
tbLotes--$ +
lote--, 0
)--0 1
{--2 3
try.. 
{.. 
var// 
query// 
=// 
(// 
from// !
e//" #
in//$ &
db//' )
.//) *
tbLotes//* 1
where//2 7
e//8 9
.//9 :
CodLote//: A
==//B D
lote//E I
.//I J
CodLote//J Q
select//R X
e//Y Z
)//Z [
.//[ \
FirstOrDefault//\ j
(//j k
)//k l
;//l m
query00 
.00 
Cantidad00 
=00  
lote00! %
.00% &
Cantidad00& .
;00. /
db11 
.11 
SaveChanges11 
(11 
)11  
;11  !
return22 
true22 
;22 
}33 
catch33 
(33 
	Exception33 
)33 
{33  !
return44 
false44 
;44 
}55 
}66 	
}77 
}88 Œ#
8F:\UPT\VII CICLO\Z JEANET\Sistema\Datos\ClsDproveedor.cs
	namespace 	
Datos
 
{ 
public 

class 
ClsDproveedor 
{  
readonly 
bdJeaNetEntities !
db" $
=% &
new' *
bdJeaNetEntities+ ;
(; <
)< =
;= >
public

 
bool

 
agregarProveedor

 $
(

$ %
tbProveedores

% 2
	proveedor

3 <
)

< =
{

> ?
try 
{ 
db 
. 
tbProveedores  
.  !
Add! $
($ %
	proveedor% .
). /
;/ 0
db 
. 
SaveChanges 
( 
)  
;  !
return 
true 
; 
} 
catch 
( 
	Exception 
) 
{  !
return 
false 
; 
} 
} 	
public 
bool 
modificarProveedor &
(& '
tbProveedores' 4
	proveedor5 >
)> ?
{@ A
try 
{ 
db 
. 
Entry 
( 
	proveedor "
)" #
.# $
State$ )
=* +
EntityState, 7
.7 8
Modified8 @
;@ A
db 
. 
SaveChanges 
( 
)  
;  !
return 
true 
; 
} 
catch 
( 
	Exception 
) 
{  !
return 
false 
; 
} 
} 	
public 
List 
< 
tbProveedores !
>! "
listarProveedor# 2
(2 3
)3 4
{5 6
var 
query 
= 
from 
e 
in !
db" $
.$ %
tbProveedores% 2
select3 9
e: ;
;; <
return   
query   
.   
ToList   
(    
)    !
;  ! "
}!! 	
public## 
List## 
<## 
tbProveedores## !
>##! "
filtrarProveedor### 3
(##3 4
string##4 :
filtro##; A
)##A B
{##C D
var$$ 
query$$ 
=$$ 
from$$ 
e$$ 
in$$ !
db$$" $
.$$$ %
tbProveedores$$% 2
where$$3 8
e$$9 :
.$$: ;
Ruc$$; >
.$$> ?
Contains$$? G
($$G H
filtro$$H N
)$$N O
||$$P R
e$$S T
.$$T U
Nombre$$U [
.$$[ \
Contains$$\ d
($$d e
filtro$$e k
)$$k l
||$$m o
e$$p q
.$$q r
	Direccion$$r {
.$${ |
Contains	$$| Ñ
(
$$Ñ Ö
filtro
$$Ö ã
)
$$ã å
||
$$ç è
e
$$ê ë
.
$$ë í
Telefono
$$í ö
.
$$ö õ
Contains
$$õ £
(
$$£ §
filtro
$$§ ™
)
$$™ ´
||
$$¨ Æ
e
$$Ø ∞
.
$$∞ ±
Correo
$$± ∑
.
$$∑ ∏
Contains
$$∏ ¿
(
$$¿ ¡
filtro
$$¡ «
)
$$« »
||
$$… À
e
$$Ã Õ
.
$$Õ Œ
Estado
$$Œ ‘
.
$$‘ ’
Contains
$$’ ›
(
$$› ﬁ
filtro
$$ﬁ ‰
)
$$‰ Â
select
$$Ê Ï
e
$$Ì Ó
;
$$Ó Ô
return%% 
query%% 
.%% 
ToList%% 
(%%  
)%%  !
;%%! "
}&& 	
public(( 
List(( 
<(( 
tbProveedores(( !
>((! "
busquedaProveedor((# 4
(((4 5
string((5 ;
ruc((< ?
)((? @
{((A B
var)) 
query)) 
=)) 
from)) 
e)) 
in)) !
db))" $
.))$ %
tbProveedores))% 2
where))3 8
e))9 :
.)): ;
Ruc)); >
==))? A
ruc))B E
select))F L
e))M N
;))N O
return** 
query** 
.** 
ToList** 
(**  
)**  !
;**! "
}++ 	
},, 
}-- ÍŸ
6F:\UPT\VII CICLO\Z JEANET\Sistema\Datos\ClsDreporte.cs
	namespace 	
Datos
 
{ 
public 

class 
ClsDreporte 
{ 
readonly 
bdJeaNetEntities !
db" $
=% &
new' *
bdJeaNetEntities+ ;
(; <
)< =
;= >
public 
	DataTable #
listarProductosSemestre 0
(0 1
)1 2
{3 4
	DataTable		 
dt		 
=		 
new		 
	DataTable		 (
(		( )
)		) *
;		* +
dt

 
.

 
Columns

 
.

 
Add

 
(

 
$str

 %
)

% &
;

& '
dt 
. 
Columns 
. 
Add 
( 
$str ,
), -
;- .
dt 
. 
Columns 
. 
Add 
( 
$str -
)- .
;. /
dt 
. 
Columns 
. 
Add 
( 
$str "
)" #
;# $
var 
query 
= 
from 
e 
in !
db" $
.$ %)
USP_S_ListarProductosSemestre% B
(B C
)C D
selectE K
eL M
;M N
foreach 
( 
var 
item 
in  
query! &
.& '
ToList' -
(- .
). /
)/ 0
{1 2
dt 
. 
Rows 
. 
Add 
( 
item  
.  !
Producto! )
,) *
item+ /
./ 0
Primer_Semestre0 ?
,? @
itemA E
.E F
Segundo_SemestreF V
,V W
itemX \
.\ ]
Total] b
)b c
;c d
} 
return 
dt 
; 
} 	
public 
	DataTable $
listarProductosTrimestre 1
(1 2
)2 3
{4 5
	DataTable 
dt 
= 
new 
	DataTable (
(( )
)) *
;* +
dt 
. 
Columns 
. 
Add 
( 
$str %
)% &
;& '
dt 
. 
Columns 
. 
Add 
( 
$str -
)- .
;. /
dt 
. 
Columns 
. 
Add 
( 
$str .
). /
;/ 0
dt 
. 
Columns 
. 
Add 
( 
$str -
)- .
;. /
dt 
. 
Columns 
. 
Add 
( 
$str -
)- .
;. /
dt 
. 
Columns 
. 
Add 
( 
$str "
)" #
;# $
var 
query 
= 
from 
e 
in !
db" $
.$ %0
$USP_S_ListarVentasProductosTrimestre% I
(I J
)J K
selectL R
eS T
;T U
foreach 
( 
var 
item 
in  
query! &
.& '
ToList' -
(- .
). /
)/ 0
{1 2
dt 
. 
Rows 
. 
Add 
( 
item  
.  !
Producto! )
,) *
item+ /
./ 0
Primer_Trimestre0 @
,@ A
itemB F
.F G
Segundo_TrimestreG X
,X Y
itemZ ^
.^ _
Tercer_Trimestre_ o
,o p
itemq u
.u v
Cuarto_Trimestre	v Ü
,
Ü á
item
à å
.
å ç
Total
ç í
)
í ì
;
ì î
}   
return!! 
dt!! 
;!! 
}"" 	
public$$ 
	DataTable$$  
listarProductosAnual$$ -
($$- .
)$$. /
{$$0 1
	DataTable%% 
dt%% 
=%% 
new%% 
	DataTable%% (
(%%( )
)%%) *
;%%* +
dt&& 
.&& 
Columns&& 
.&& 
Add&& 
(&& 
$str&& %
)&&% &
;&&& '
dt'' 
.'' 
Columns'' 
.'' 
Add'' 
('' 
$str''  
)''  !
;''! "
dt(( 
.(( 
Columns(( 
.(( 
Add(( 
((( 
$str(( "
)((" #
;((# $
var)) 
query)) 
=)) 
from)) 
e)) 
in)) !
db))" $
.))$ %.
"USP_S_ListarProductosVendidosAnual))% G
())G H
)))H I
select))J P
e))Q R
;))R S
foreach** 
(** 
var** 
item** 
in**  
query**! &
.**& '
ToList**' -
(**- .
)**. /
)**/ 0
{**1 2
dt++ 
.++ 
Rows++ 
.++ 
Add++ 
(++ 
item++  
.++  !
Producto++! )
,++) *
item+++ /
.++/ 0
A√±o++0 3
,++3 4
item++5 9
.++9 :
Total++: ?
)++? @
;++@ A
},, 
return-- 
dt-- 
;-- 
}.. 	
public00 
	DataTable00 
listarProductosMes00 +
(00+ ,
)00, -
{00. /
	DataTable11 
dt11 
=11 
new11 
	DataTable11 (
(11( )
)11) *
;11* +
dt22 
.22 
Columns22 
.22 
Add22 
(22 
$str22 %
)22% &
;22& '
dt33 
.33 
Columns33 
.33 
Add33 
(33 
$str33 "
)33" #
;33# $
dt44 
.44 
Columns44 
.44 
Add44 
(44 
$str44 $
)44$ %
;44% &
dt55 
.55 
Columns55 
.55 
Add55 
(55 
$str55 "
)55" #
;55# $
dt66 
.66 
Columns66 
.66 
Add66 
(66 
$str66 "
)66" #
;66# $
dt77 
.77 
Columns77 
.77 
Add77 
(77 
$str77 !
)77! "
;77" #
dt88 
.88 
Columns88 
.88 
Add88 
(88 
$str88 "
)88" #
;88# $
dt99 
.99 
Columns99 
.99 
Add99 
(99 
$str99 "
)99" #
;99# $
dt:: 
.:: 
Columns:: 
.:: 
Add:: 
(:: 
$str:: #
)::# $
;::$ %
dt;; 
.;; 
Columns;; 
.;; 
Add;; 
(;; 
$str;; '
);;' (
;;;( )
dt<< 
.<< 
Columns<< 
.<< 
Add<< 
(<< 
$str<< $
)<<$ %
;<<% &
dt== 
.== 
Columns== 
.== 
Add== 
(== 
$str== &
)==& '
;==' (
dt>> 
.>> 
Columns>> 
.>> 
Add>> 
(>> 
$str>> &
)>>& '
;>>' (
dt?? 
.?? 
Columns?? 
.?? 
Add?? 
(?? 
$str?? "
)??" #
;??# $
var@@ 
query@@ 
=@@ 
from@@ 
e@@ 
in@@ !
db@@" $
.@@$ %,
 USP_S_ListarPRoductosVendidosMes@@% E
(@@E F
)@@F G
select@@H N
e@@O P
;@@P Q
foreachAA 
(AA 
varAA 
itemAA 
inAA  
queryAA! &
.AA& '
ToListAA' -
(AA- .
)AA. /
)AA/ 0
{AA1 2
dtBB 
.BB 
RowsBB 
.BB 
AddBB 
(BB 
itemBB  
.BB  !
ProductoBB! )
,BB) *
itemBB+ /
.BB/ 0
EneroBB0 5
,BB5 6
itemBB7 ;
.BB; <
FebreroBB< C
,BBC D
itemBBE I
.BBI J
MarzoBBJ O
,BBO P
itemBBQ U
.BBU V
AbrilBBV [
,BB[ \
itemBB] a
.BBa b
MayoBBb f
,BBf g
itemBBh l
.BBl m
JunioBBm r
,BBr s
itemBBt x
.BBx y
JulioBBy ~
,BB~ 
item
BBÄ Ñ
.
BBÑ Ö
Agosto
BBÖ ã
,
BBã å
item
BBç ë
.
BBë í

Septiembre
BBí ú
,
BBú ù
item
BBû ¢
.
BB¢ £
Octubre
BB£ ™
,
BB™ ´
item
BB¨ ∞
.
BB∞ ±
	Noviembre
BB± ∫
,
BB∫ ª
item
BBº ¿
.
BB¿ ¡
	Diciembre
BB¡  
,
BB  À
item
BBÃ –
.
BB– —
Total
BB— ÷
)
BB÷ ◊
;
BB◊ ÿ
}CC 
returnDD 
dtDD 
;DD 
}EE 	
publicGG 
	DataTableGG "
listarProductosSemanalGG /
(GG/ 0
)GG0 1
{GG2 3
	DataTableHH 
dtHH 
=HH 
newHH 
	DataTableHH (
(HH( )
)HH) *
;HH* +
dtII 
.II 
ColumnsII 
.II 
AddII 
(II 
$strII %
)II% &
;II& '
dtJJ 
.JJ 
ColumnsJJ 
.JJ 
AddJJ 
(JJ 
$strJJ "
)JJ" #
;JJ# $
dtKK 
.KK 
ColumnsKK 
.KK 
AddKK 
(KK 
$strKK #
)KK# $
;KK$ %
dtLL 
.LL 
ColumnsLL 
.LL 
AddLL 
(LL 
$strLL &
)LL& '
;LL' (
dtMM 
.MM 
ColumnsMM 
.MM 
AddMM 
(MM 
$strMM #
)MM# $
;MM$ %
dtNN 
.NN 
ColumnsNN 
.NN 
AddNN 
(NN 
$strNN $
)NN$ %
;NN% &
dtOO 
.OO 
ColumnsOO 
.OO 
AddOO 
(OO 
$strOO #
)OO# $
;OO$ %
dtPP 
.PP 
ColumnsPP 
.PP 
AddPP 
(PP 
$strPP $
)PP$ %
;PP% &
dtQQ 
.QQ 
ColumnsQQ 
.QQ 
AddQQ 
(QQ 
$strQQ "
)QQ" #
;QQ# $
varRR 
queryRR 
=RR 
fromRR 
eRR 
inRR !
dbRR" $
.RR$ %/
#USP_S_ListarProductosVendidosSemanaRR% H
(RRH I
)RRI J
selectRRK Q
eRRR S
;RRS T
foreachSS 
(SS 
varSS 
itemSS 
inSS  
querySS! &
.SS& '
ToListSS' -
(SS- .
)SS. /
)SS/ 0
{SS1 2
dtTT 
.TT 
RowsTT 
.TT 
AddTT 
(TT 
itemTT  
.TT  !
ProductoTT! )
,TT) *
itemTT+ /
.TT/ 0
LunesTT0 5
,TT5 6
itemTT7 ;
.TT; <
MartesTT< B
,TTB C
itemTTD H
.TTH I
	MiercolesTTI R
,TTR S
itemTTT X
.TTX Y
JuevesTTY _
,TT_ `
itemTTa e
.TTe f
ViernesTTf m
,TTm n
itemTTo s
.TTs t
SabadoTTt z
,TTz {
item	TT| Ä
.
TTÄ Å
Domingo
TTÅ à
,
TTà â
item
TTä é
.
TTé è
Total
TTè î
)
TTî ï
;
TTï ñ
}UU 
returnVV 
dtVV 
;VV 
}WW 	
publicYY 
	DataTableYY 
listarIncidenciasYY *
(YY* +
)YY+ ,
{YY- .
	DataTableZZ 
dtZZ 
=ZZ 
newZZ 
	DataTableZZ (
(ZZ( )
)ZZ) *
;ZZ* +
dt[[ 
.[[ 
Columns[[ 
.[[ 
Add[[ 
([[ 
$str[[ #
)[[# $
;[[$ %
dt\\ 
.\\ 
Columns\\ 
.\\ 
Add\\ 
(\\ 
$str\\ #
)\\# $
;\\$ %
dt]] 
.]] 
Columns]] 
.]] 
Add]] 
(]] 
$str]] "
)]]" #
;]]# $
var^^ 
query^^ 
=^^ 
from^^ 
e^^ 
in^^ !
db^^" $
.^^$ %#
USP_S_ListarIncidencias^^% <
(^^< =
)^^= >
select^^? E
e^^F G
;^^G H
foreach__ 
(__ 
var__ 
item__ 
in__  
query__! &
.__& '
ToList__' -
(__- .
)__. /
)__/ 0
{__1 2
dt`` 
.`` 
Rows`` 
.`` 
Add`` 
(`` 
item``  
.``  !
Ma√±ana``! '
,``' (
item``) -
.``- .
Tarde``. 3
,``3 4
item``5 9
.``9 :
Noche``: ?
)``? @
;``@ A
}aa 
returnbb 
dtbb 
;bb 
}cc 	
publicee 
	DataTableee '
listarEmpleadoVentaSemestreee 4
(ee4 5
)ee5 6
{ee7 8
	DataTableff 
dtff 
=ff 
newff 
	DataTableff (
(ff( )
)ff) *
;ff* +
dtgg 
.gg 
Columnsgg 
.gg 
Addgg 
(gg 
$strgg %
)gg% &
;gg& '
dthh 
.hh 
Columnshh 
.hh 
Addhh 
(hh 
$strhh ,
)hh, -
;hh- .
dtii 
.ii 
Columnsii 
.ii 
Addii 
(ii 
$strii -
)ii- .
;ii. /
dtjj 
.jj 
Columnsjj 
.jj 
Addjj 
(jj 
$strjj "
)jj" #
;jj# $
varkk 
querykk 
=kk 
fromkk 
ekk 
inkk !
dbkk" $
.kk$ %3
'USP_S_ListarVentaDeEmpleadosPorSemestrekk% L
(kkL M
)kkM N
selectkkO U
ekkV W
;kkW X
foreachll 
(ll 
varll 
itemll 
inll  
queryll! &
.ll& '
ToListll' -
(ll- .
)ll. /
)ll/ 0
{ll1 2
dtmm 
.mm 
Rowsmm 
.mm 
Addmm 
(mm 
itemmm  
.mm  !
Empleadomm! )
,mm) *
itemmm+ /
.mm/ 0
Primer_Semestremm0 ?
,mm? @
itemmmA E
.mmE F
Segundo_SemestremmF V
,mmV W
itemmmX \
.mm\ ]
Totalmm] b
)mmb c
;mmc d
}nn 
returnoo 
dtoo 
;oo 
}pp 	
publicrr 
	DataTablerr (
listarEmpleadoVentaTrimestrerr 5
(rr5 6
)rr6 7
{rr8 9
	DataTabless 
dtss 
=ss 
newss 
	DataTabless (
(ss( )
)ss) *
;ss* +
dttt 
.tt 
Columnstt 
.tt 
Addtt 
(tt 
$strtt %
)tt% &
;tt& '
dtuu 
.uu 
Columnsuu 
.uu 
Adduu 
(uu 
$struu -
)uu- .
;uu. /
dtvv 
.vv 
Columnsvv 
.vv 
Addvv 
(vv 
$strvv .
)vv. /
;vv/ 0
dtww 
.ww 
Columnsww 
.ww 
Addww 
(ww 
$strww -
)ww- .
;ww. /
dtxx 
.xx 
Columnsxx 
.xx 
Addxx 
(xx 
$strxx -
)xx- .
;xx. /
dtyy 
.yy 
Columnsyy 
.yy 
Addyy 
(yy 
$stryy "
)yy" #
;yy# $
varzz 
queryzz 
=zz 
fromzz 
ezz 
inzz !
dbzz" $
.zz$ %4
(USP_S_ListarVentaDeEmpleadosPorTrimestrezz% M
(zzM N
)zzN O
selectzzP V
ezzW X
;zzX Y
foreach{{ 
({{ 
var{{ 
item{{ 
in{{  
query{{! &
.{{& '
ToList{{' -
({{- .
){{. /
){{/ 0
{{{1 2
dt|| 
.|| 
Rows|| 
.|| 
Add|| 
(|| 
item||  
.||  !
Empleado||! )
,||) *
item||+ /
.||/ 0
Primer_Trimestre||0 @
,||@ A
item||B F
.||F G
Segundo_Trimestre||G X
,||X Y
item||Z ^
.||^ _
Tercer_Trimestre||_ o
,||o p
item||q u
.||u v
Cuarto_Trimestre	||v Ü
,
||Ü á
item
||à å
.
||å ç
Total
||ç í
)
||í ì
;
||ì î
}}} 
return~~ 
dt~~ 
;~~ 
} 	
public
ÅÅ 
	DataTable
ÅÅ &
listarEmpleadoVentaAnual
ÅÅ 1
(
ÅÅ1 2
)
ÅÅ2 3
{
ÅÅ4 5
	DataTable
ÇÇ 
dt
ÇÇ 
=
ÇÇ 
new
ÇÇ 
	DataTable
ÇÇ (
(
ÇÇ( )
)
ÇÇ) *
;
ÇÇ* +
dt
ÉÉ 
.
ÉÉ 
Columns
ÉÉ 
.
ÉÉ 
Add
ÉÉ 
(
ÉÉ 
$str
ÉÉ %
)
ÉÉ% &
;
ÉÉ& '
dt
ÑÑ 
.
ÑÑ 
Columns
ÑÑ 
.
ÑÑ 
Add
ÑÑ 
(
ÑÑ 
$str
ÑÑ  
)
ÑÑ  !
;
ÑÑ! "
dt
ÖÖ 
.
ÖÖ 
Columns
ÖÖ 
.
ÖÖ 
Add
ÖÖ 
(
ÖÖ 
$str
ÖÖ "
)
ÖÖ" #
;
ÖÖ# $
var
ÜÜ 
query
ÜÜ 
=
ÜÜ 
from
ÜÜ 
e
ÜÜ 
in
ÜÜ !
db
ÜÜ" $
.
ÜÜ$ %-
USP_S_ListarVentasEmpleadoAnual
ÜÜ% D
(
ÜÜD E
)
ÜÜE F
select
ÜÜG M
e
ÜÜN O
;
ÜÜO P
foreach
áá 
(
áá 
var
áá 
item
áá 
in
áá  
query
áá! &
.
áá& '
ToList
áá' -
(
áá- .
)
áá. /
)
áá/ 0
{
áá1 2
dt
àà 
.
àà 
Rows
àà 
.
àà 
Add
àà 
(
àà 
item
àà  
.
àà  !
Empleado
àà! )
,
àà) *
item
àà+ /
.
àà/ 0
A√±o
àà0 3
,
àà3 4
item
àà5 9
.
àà9 :
Total
àà: ?
)
àà? @
;
àà@ A
}
ââ 
return
ää 
dt
ää 
;
ää 
}
ãã 	
public
çç 
	DataTable
çç (
listarEmpleadoVentaMensual
çç 3
(
çç3 4
)
çç4 5
{
çç6 7
	DataTable
éé 
dt
éé 
=
éé 
new
éé 
	DataTable
éé (
(
éé( )
)
éé) *
;
éé* +
dt
èè 
.
èè 
Columns
èè 
.
èè 
Add
èè 
(
èè 
$str
èè %
)
èè% &
;
èè& '
dt
êê 
.
êê 
Columns
êê 
.
êê 
Add
êê 
(
êê 
$str
êê "
)
êê" #
;
êê# $
dt
ëë 
.
ëë 
Columns
ëë 
.
ëë 
Add
ëë 
(
ëë 
$str
ëë $
)
ëë$ %
;
ëë% &
dt
íí 
.
íí 
Columns
íí 
.
íí 
Add
íí 
(
íí 
$str
íí "
)
íí" #
;
íí# $
dt
ìì 
.
ìì 
Columns
ìì 
.
ìì 
Add
ìì 
(
ìì 
$str
ìì "
)
ìì" #
;
ìì# $
dt
îî 
.
îî 
Columns
îî 
.
îî 
Add
îî 
(
îî 
$str
îî !
)
îî! "
;
îî" #
dt
ïï 
.
ïï 
Columns
ïï 
.
ïï 
Add
ïï 
(
ïï 
$str
ïï "
)
ïï" #
;
ïï# $
dt
ññ 
.
ññ 
Columns
ññ 
.
ññ 
Add
ññ 
(
ññ 
$str
ññ "
)
ññ" #
;
ññ# $
dt
óó 
.
óó 
Columns
óó 
.
óó 
Add
óó 
(
óó 
$str
óó #
)
óó# $
;
óó$ %
dt
òò 
.
òò 
Columns
òò 
.
òò 
Add
òò 
(
òò 
$str
òò '
)
òò' (
;
òò( )
dt
ôô 
.
ôô 
Columns
ôô 
.
ôô 
Add
ôô 
(
ôô 
$str
ôô $
)
ôô$ %
;
ôô% &
dt
öö 
.
öö 
Columns
öö 
.
öö 
Add
öö 
(
öö 
$str
öö &
)
öö& '
;
öö' (
dt
õõ 
.
õõ 
Columns
õõ 
.
õõ 
Add
õõ 
(
õõ 
$str
õõ &
)
õõ& '
;
õõ' (
dt
úú 
.
úú 
Columns
úú 
.
úú 
Add
úú 
(
úú 
$str
úú "
)
úú" #
;
úú# $
var
ùù 
query
ùù 
=
ùù 
from
ùù 
e
ùù 
in
ùù !
db
ùù" $
.
ùù$ %4
&USP_S_ListarVentasMensualesPorEmpleado
ùù% K
(
ùùK L
)
ùùL M
select
ùùN T
e
ùùU V
;
ùùV W
foreach
ûû 
(
ûû 
var
ûû 
item
ûû 
in
ûû  
query
ûû! &
.
ûû& '
ToList
ûû' -
(
ûû- .
)
ûû. /
)
ûû/ 0
{
ûû1 2
dt
üü 
.
üü 
Rows
üü 
.
üü 
Add
üü 
(
üü 
item
üü  
.
üü  !
Empleado
üü! )
,
üü) *
item
üü+ /
.
üü/ 0
Enero
üü0 5
,
üü5 6
item
üü7 ;
.
üü; <
Febrero
üü< C
,
üüC D
item
üüE I
.
üüI J
Marzo
üüJ O
,
üüO P
item
üüQ U
.
üüU V
Abril
üüV [
,
üü[ \
item
üü] a
.
üüa b
Mayo
üüb f
,
üüf g
item
üüh l
.
üül m
Junio
üüm r
,
üür s
item
üüt x
.
üüx y
Julio
üüy ~
,
üü~ 
itemüüÄ Ñ
.üüÑ Ö
AgostoüüÖ ã
,üüã å
itemüüç ë
.üüë í

Septiembreüüí ú
,üüú ù
itemüüû ¢
.üü¢ £
Octubreüü£ ™
,üü™ ´
itemüü¨ ∞
.üü∞ ±
	Noviembreüü± ∫
,üü∫ ª
itemüüº ¿
.üü¿ ¡
	Diciembreüü¡  
,üü  À
itemüüÃ –
.üü– —
Totalüü— ÷
)üü÷ ◊
;üü◊ ÿ
}
†† 
return
°° 
dt
°° 
;
°° 
}
¢¢ 	
public
§§ 
	DataTable
§§ $
listarEmpleadoVentaDia
§§ /
(
§§/ 0
)
§§0 1
{
§§2 3
	DataTable
•• 
dt
•• 
=
•• 
new
•• 
	DataTable
•• (
(
••( )
)
••) *
;
••* +
dt
¶¶ 
.
¶¶ 
Columns
¶¶ 
.
¶¶ 
Add
¶¶ 
(
¶¶ 
$str
¶¶ %
)
¶¶% &
;
¶¶& '
dt
ßß 
.
ßß 
Columns
ßß 
.
ßß 
Add
ßß 
(
ßß 
$str
ßß "
)
ßß" #
;
ßß# $
dt
®® 
.
®® 
Columns
®® 
.
®® 
Add
®® 
(
®® 
$str
®® #
)
®®# $
;
®®$ %
dt
©© 
.
©© 
Columns
©© 
.
©© 
Add
©© 
(
©© 
$str
©© &
)
©©& '
;
©©' (
dt
™™ 
.
™™ 
Columns
™™ 
.
™™ 
Add
™™ 
(
™™ 
$str
™™ #
)
™™# $
;
™™$ %
dt
´´ 
.
´´ 
Columns
´´ 
.
´´ 
Add
´´ 
(
´´ 
$str
´´ $
)
´´$ %
;
´´% &
dt
¨¨ 
.
¨¨ 
Columns
¨¨ 
.
¨¨ 
Add
¨¨ 
(
¨¨ 
$str
¨¨ #
)
¨¨# $
;
¨¨$ %
dt
≠≠ 
.
≠≠ 
Columns
≠≠ 
.
≠≠ 
Add
≠≠ 
(
≠≠ 
$str
≠≠ $
)
≠≠$ %
;
≠≠% &
dt
ÆÆ 
.
ÆÆ 
Columns
ÆÆ 
.
ÆÆ 
Add
ÆÆ 
(
ÆÆ 
$str
ÆÆ "
)
ÆÆ" #
;
ÆÆ# $
var
ØØ 
query
ØØ 
=
ØØ 
from
ØØ 
e
ØØ 
in
ØØ !
db
ØØ" $
.
ØØ$ %.
 USP_S_ListarVentasPorDiaEmpleado
ØØ% E
(
ØØE F
)
ØØF G
select
ØØH N
e
ØØO P
;
ØØP Q
foreach
∞∞ 
(
∞∞ 
var
∞∞ 
item
∞∞ 
in
∞∞  
query
∞∞! &
.
∞∞& '
ToList
∞∞' -
(
∞∞- .
)
∞∞. /
)
∞∞/ 0
{
∞∞1 2
dt
±± 
.
±± 
Rows
±± 
.
±± 
Add
±± 
(
±± 
item
±±  
.
±±  !
Empleado
±±! )
,
±±) *
item
±±+ /
.
±±/ 0
Lunes
±±0 5
,
±±5 6
item
±±7 ;
.
±±; <
Martes
±±< B
,
±±B C
item
±±D H
.
±±H I
	Miercoles
±±I R
,
±±R S
item
±±T X
.
±±X Y
Jueves
±±Y _
,
±±_ `
item
±±a e
.
±±e f
Viernes
±±f m
,
±±m n
item
±±o s
.
±±s t
Sabado
±±t z
,
±±z {
item±±| Ä
.±±Ä Å
Domingo±±Å à
,±±à â
item±±ä é
.±±é è
Total±±è î
)±±î ï
;±±ï ñ
}
≤≤ 
return
≥≥ 
dt
≥≥ 
;
≥≥ 
}
¥¥ 	
}
µµ 
}∂∂ û
7F:\UPT\VII CICLO\Z JEANET\Sistema\Datos\ClsDsesiones.cs
	namespace 	
Datos
 
{ 
public 
class 
ClsDsesiones  
{! "
readonly 
bdJeaNetEntities !
db" $
=% &
new' *
bdJeaNetEntities+ ;
(; <
)< =
;= >
public

 
	DataTable

 
buscarSesion

 %
(

% &
string

& ,
usuario

- 4
)

4 5
{

6 7
	DataTable 
dt 
= 
new 
	DataTable (
(( )
)) *
;* +
dt 
. 
Columns 
. 
Add 
( 
$str 
)  
;  !
dt 
. 
Columns 
. 
Add 
( 
$str $
)$ %
;% &
var 
query 
= 
from 
e 
in !
db" $
.$ %

tbSesiones% /
where0 5
e6 7
.7 8
usuario8 ?
==@ B
usuarioC J
selectK Q
eR S
;S T
foreach 
( 
var 
item 
in  
query! &
.& '
ToList' -
(- .
). /
)/ 0
{1 2
dt 
. 
Rows 
. 
Add 
( 
item  
.  !
id! #
,# $
item% )
.) *
usuario* 1
)1 2
;2 3
} 
return 
dt 
; 
} 	
public 
void 
eliminarSesion "
(" #
string# )
usuario* 1
)1 2
{3 4

tbSesiones 
sesion 
= 
db  "
." #

tbSesiones# -
.- .
Single. 4
(4 5
x5 6
=>7 9
x: ;
.; <
usuario< C
==D F
usuarioG N
)N O
;O P
db 
. 

tbSesiones 
. 
Remove  
(  !
sesion! '
)' (
;( )
db 
. 
SaveChanges 
( 
) 
; 
} 	
public 
bool 
guardarSesion !
(! "
string" (
usuario) 0
)0 1
{2 3
try 
{ 

tbSesiones   
sesion   !
=  " #

tbSesiones  $ .
.  . /
crear  / 4
(  4 5
usuario  5 <
)  < =
;  = >
db!! 
.!! 
Entry!! 
(!! 
sesion!! 
)!!  
.!!  !
State!!! &
=!!' (
EntityState!!) 4
.!!4 5
Added!!5 :
;!!: ;
db"" 
."" 
SaveChanges"" 
("" 
)""  
;""  !
return## 
true## 
;## 
}$$ 
catch$$ 
($$ 
	Exception$$ 
)$$ 
{$$  !
return%% 
false%% 
;%% 
}&& 
}'' 	
}(( 
})) á
2F:\UPT\VII CICLO\Z JEANET\Sistema\Datos\Program.cs
	namespace 	
Datos
 
{ 
static 

class 
Program 
{ 
[		 	
	STAThread			 
]		 
static

 
void

 
Main

 
(

 
)

 
{

 
Application 
. 
EnableVisualStyles *
(* +
)+ ,
;, -
Application 
. -
!SetCompatibleTextRenderingDefault 9
(9 :
false: ?
)? @
;@ A
} 	
} 
} Ì
BF:\UPT\VII CICLO\Z JEANET\Sistema\Datos\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str  
)  !
]! "
[ 
assembly 	
:	 

AssemblyDescription 
( 
$str !
)! "
]" #
[		 
assembly		 	
:			 
!
AssemblyConfiguration		  
(		  !
$str		! #
)		# $
]		$ %
[

 
assembly

 	
:

	 

AssemblyCompany

 
(

 
$str

 
)

 
]

 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str "
)" #
]# $
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
["" 
assembly"" 	
:""	 

AssemblyVersion"" 
("" 
$str"" $
)""$ %
]""% &
[## 
assembly## 	
:##	 

AssemblyFileVersion## 
(## 
$str## (
)##( )
]##) *